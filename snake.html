<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<title>Pixel Snake â€“ Ceruledge Gate</title>

<style>
html, body {
    margin: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: #000;
    font-family: monospace;
}

/* ===== GAME ===== */
#gameScreen {
    position: fixed;
    inset: 0;
    display: flex;
    flex-direction: column;
}

#hud {
    background: #111;
    color: white;
    text-align: center;
    padding: 8px;
    font-size: 16px;
}

canvas {
    flex: 1;
    background: #77aa33;
}

/* ---- TOUCH / VISIBLE JOYSTICK ---- */
.controls {
    height: 160px;
    position: relative;
}

#joystick {
    position: absolute;
    left: 20px;
    bottom: 20px;
    width: 120px;
    height: 120px;
    background: rgba(255,255,255,.15);
    border-radius: 50%;
}

#stick {
    position: absolute;
    left: 50%;
    top: 50%;
    width: 46px;
    height: 46px;
    background: rgba(0,200,255,.9);
    border-radius: 50%;
    transform: translate(-50%,-50%);
}

/* ===== WELCOME / LOGIN ===== */
#welcomeOverlay {
    position: fixed;
    inset: 0;
    background: radial-gradient(circle at top left, #6a4cff, #1b102f);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
}

.welcomeCard {
    width: 90%;
    max-width: 600px;
    height: auto;
    background: linear-gradient(135deg, #7f5cff, #ff8c42);
    border-radius: 18px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    box-shadow: 0 0 40px rgba(255,140,66,.6);
    animation: popIn .6s ease;
}

@keyframes popIn {
    from { transform: scale(.8); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
}

.welcomeLeft {
    padding: 16px;
    color: white;
    text-align: center;
}

.welcomeLeft img {
    width: 70%;
    max-width: 260px;
    height: auto;
    object-fit: contain;
    filter:
        contrast(1.15)
        saturate(1.2)
        brightness(.9)
        drop-shadow(0 0 20px rgba(140,60,255,.95))
        drop-shadow(0 0 50px rgba(90,0,200,.8));
}

.welcomeLeft h1 {
    margin: 12px 0 6px 0;
    font-size: 24px;
}

.welcomeLeft p {
    font-size: 16px;
    line-height: 1.3;
}

.welcomeRight {
    background: rgba(255,255,255,.95);
    padding: 16px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-top: 12px;
    border-radius: 12px;
}

.welcomeRight input {
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #ccc;
    font-size: 16px;
    width: 100%;
    box-sizing: border-box;
}

.welcomeRight button {
    padding: 12px;
    border-radius: 10px;
    border: none;
    background: linear-gradient(135deg,#7f5cff,#ff8c42);
    color: white;
    font-size: 16px;
    cursor: pointer;
}

.welcomeRight button:hover {
    filter: brightness(1.1);
}

#error {
    color: red;
    text-align: center;
    font-size: 14px;
}

/* responsive adjustments */
@media (min-width: 600px) {
    .welcomeCard {
        flex-direction: row;
        height: 420px;
    }
    .welcomeLeft {
        flex: 1;
        padding: 24px;
    }
    .welcomeRight {
        width: 260px;
        margin-top: 0;
    }
}
</style>
</head>

<body>

<!-- ===== WELCOME / LOGIN ===== -->
<div id="welcomeOverlay">
  <div class="welcomeCard">

    <div class="welcomeLeft">
      <img src="https://archives.bulbagarden.net/media/upload/f/f0/0937Ceruledge.png" alt="Ceruledge" />
      <h1>Welcome, Trainer</h1>
      <p>Only the chosen one may enter.<br />Ceruledge stands guard.</p>
    </div>

    <div class="welcomeRight">
      <h2>Trainer Login</h2>
      <input id="trainerName" placeholder="Trainer Name" />
      <button id="startBtn">Enter Arena</button>
      <div id="error"></div>
    </div>

  </div>
</div>

<!-- ===== GAME ===== -->
<div id="gameScreen">
  <div id="hud">Pixel Snake</div>
  <canvas id="game"></canvas>
  <div class="controls">
    <div id="joystick"><div id="stick"></div></div>
  </div>
</div>

<script>
/* ---------- LOGIN GATE ---------- */
const startBtn = document.getElementById("startBtn");
const overlay = document.getElementById("welcomeOverlay");
const nameInput = document.getElementById("trainerName");
const error = document.getElementById("error");

startBtn.onclick = () => {
    if (nameInput.value.trim().toLowerCase() === "dwight") {
        overlay.style.display = "none";
        startGame();
    } else {
        error.textContent = "Access denied. Ceruledge rejects you.";
    }
};

/* ---------- SETUP ---------- */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const size = 24;
let snake, food, dir = "RIGHT", loop;

function resize(){
    canvas.width = canvas.clientWidth;
    canvas.height = canvas.clientHeight;
}
window.addEventListener("resize", resize);
resize();

/* ---------- GAME ---------- */
function startGame(){
    const cx = Math.floor(canvas.width/2/size)*size;
    const cy = Math.floor(canvas.height/2/size)*size;
    snake = [
        {x:cx,y:cy},
        {x:cx-size,y:cy},
        {x:cx-size*2,y:cy}
    ];
    food = spawnFood();
    clearInterval(loop);
    loop = setInterval(update,150);
}

function spawnFood(){
    return {
        x: Math.floor(Math.random()*canvas.width/size)*size,
        y: Math.floor(Math.random()*canvas.height/size)*size
    };
}

function update(){
    const h = {...snake[0]};
    if(dir==="LEFT")h.x-=size;
    if(dir==="RIGHT")h.x+=size;
    if(dir==="UP")h.y-=size;
    if(dir==="DOWN")h.y+=size;

    if(h.x<0||h.y<0||h.x>=canvas.width||h.y>=canvas.height) return startGame();
    if(snake.some(s=>s.x===h.x&&s.y===h.y)) return startGame();

    snake.unshift(h);
    if(h.x===food.x && h.y===food.y){
        food = spawnFood();
    } else snake.pop();

    draw();
}

/* ---------- DRAW ---------- */
function draw(){
    ctx.fillStyle = "#77aa33";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    drawFood();
    drawSnake();
}

function drawFood(){
    ctx.fillStyle = "#c40000";
    ctx.fillRect(food.x+4,food.y+4,size-8,size-8);
}

function drawSnake(){
    for(let i=0;i<snake.length;i++){
        ctx.fillStyle = i===0 ? "#5dff5d" : "#3aff3a";
        ctx.fillRect(snake[i].x+2,snake[i].y+2,size-4,size-4);
    }
}

/* ---------- TOUCH JOYSTICK ---------- */
const joystick = document.getElementById("joystick");
let dragging=false, center={x:0,y:0};

joystick.addEventListener("touchstart",start);
joystick.addEventListener("mousedown",start);
document.addEventListener("touchmove",move);
document.addEventListener("mousemove",move);
document.addEventListener("touchend",end);
document.addEventListener("mouseup",end);

function start(e){
    dragging=true;
    const t=e.touches?e.touches[0]:e;
    const r=joystick.getBoundingClientRect();
    center={x:r.left+r.width/2,y:r.top+r.height/2};
}

function move(e){
    if(!dragging) return;
    const t=e.touches?e.touches[0]:e;
    const dx=t.clientX-center.x;
    const dy=t.clientY-center.y;
    dir = Math.abs(dx)>Math.abs(dy) ? (dx>0?"RIGHT":"LEFT") : (dy>0?"DOWN":"UP");
}

function end(){
    dragging=false;
}
</script>

</body>
</html>

